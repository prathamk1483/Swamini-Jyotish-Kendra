<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jyotish Karyalay - Document Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@400;600;700&family=Noto+Sans+Devanagari:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #0A2E4B;
            --accent-green: #187A22;
            --border-color: #D3D9DE;
            --bg-color: #F8F9FA;
            --text-dark: #212529;
            --sidebar-bg: #2C3E50;
        }

        body { font-family: 'Mukta', 'Noto Sans Devanagari', sans-serif; margin: 0; padding: 0; background-color: #e9ecef; color: var(--text-dark); -webkit-print-color-adjust: exact; print-color-adjust: exact; display: flex; height: 100vh; overflow: hidden; }

        .sidebar { width: 300px; background-color: var(--sidebar-bg); color: white; padding: 20px; box-shadow: 2px 0 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; z-index: 10; overflow-y: auto; }
        .sidebar h2 { margin-top: 0; font-size: 20px; border-bottom: 1px solid #455A64; padding-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-size: 14px; color: #B0BEC5; }
        
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 1px solid #455A64; border-radius: 4px; background-color: #34495E; color: white; font-size: 16px; box-sizing: border-box; }
        .form-group input[type="time"]::-webkit-calendar-picker-indicator, .form-group input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); }

        .print-btn { margin-top: 20px; margin-bottom: 20px; background-color: #F47A20; color: white; border: none; padding: 15px; font-size: 16px; font-weight: bold; border-radius: 4px; cursor: pointer; transition: background-color 0.2s; width: 100%; }

        .main-workspace { flex: 1; padding: 40px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; gap: 40px; }
        
        /* Page Container Styles */
        .page-container { width: 850px; background: white; padding: 30px 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 8px; box-sizing: border-box; flex-shrink: 0; }
        
        /* Page 1 Specific Styles */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 10px; }
        .header h1 { font-size: 24px; color: var(--primary-blue); margin: 0; }
        .logo-area { display: flex; align-items: center; font-size: 24px; font-weight: 700; color: var(--primary-blue); }
        .logo-area span.swastik { color: #F47A20; font-size: 30px; margin-right: 10px; }

        .box { border: 1px solid var(--border-color); border-radius: 6px; background: white; margin-bottom: 12px; padding: 12px; }
        .info-box { text-align: center; background-color: #fafbfc; }
        .info-row-1 { font-size: 18px; margin-bottom: 5px; }
        .info-row-1 strong { color: var(--primary-blue); }
        .info-row-2 { font-size: 18px; color: var(--primary-blue); }

        .summary-box { display: flex; justify-content: space-between; align-items: center; padding: 12px 30px; background-color: #fafbfc; }
        .summary-item { text-align: center; }
        .rashi-title { font-size: 20px; font-weight: bold; color: var(--accent-green); }
        .lagna-title { font-size: 16px; color: var(--accent-green); margin-top: 5px; }
        .summary-center h3 { margin: 0 0 5px 0; font-size: 20px; color: var(--accent-green); }
        .summary-center p { margin: 0; font-size: 14px; color: var(--accent-green); }
        .mangal-dosh { text-decoration: line-through; color: var(--text-dark); }

        .details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 12px; }
        .detail-card { padding: 12px; background-color: #fafbfc; display: flex; justify-content: center; }
        .detail-table { border-collapse: collapse; width: 100%; }
        .detail-table td { padding: 2px 8px; font-size: 15px; }
        .detail-table td:first-child { text-align: right; color: var(--text-dark); width: 50%; }
        .detail-table td:last-child { color: var(--accent-green); font-weight: 500; }

        .main-content { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 15px; background-color: #fafbfc; }
        .svg-chart { width: 100%; height: auto; max-width: 320px; margin: 0 auto; display: block; }
        .chart-lines { stroke: #a0aab5; stroke-width: 1; fill: none; }
        .chart-num { font-size: 10px; fill: var(--text-dark); }
        .chart-planet { font-size: 12px; fill: #4A90E2; font-weight: 600; }

        .planet-table-section h3 { margin-top: 0; color: var(--primary-blue); font-size: 18px; margin-bottom: 10px; }
        .planet-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .planet-table th { text-align: left; padding-bottom: 8px; color: var(--text-dark); font-weight: 600; }
        .planet-table td { padding: 4px 0; color: var(--text-dark); }
        .planet-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 5px; vertical-align: middle; }
        .dot-sun { background: #F47A20; } .dot-moon { background: #95A5A6; } .dot-merc { background: #7F8C8D; } .dot-ven { background: #F1C40F; } .dot-mars { background: #E74C3C; } .dot-jup { background: #A0522D; } .dot-sat { background: #7A8498; } .dot-node { background: transparent; }
        .footer-note { margin-top: 10px; font-size: 12px; color: var(--primary-blue); }

        /* Page 2 (Dasha) Specific Styles */
        .dasha-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; }
        .dasha-box { border: 1px solid var(--border-color); border-radius: 4px; overflow: hidden; }
        .dasha-header-row { background-color: var(--primary-blue); color: white; text-align: center; padding: 6px; font-weight: bold; font-size: 15px; }
        .dasha-table-inner { width: 100%; border-collapse: collapse; font-size: 14px; text-align: center; }
        .dasha-table-inner td { padding: 4px; border-bottom: 1px solid #eaedf0; }
        .dasha-table-inner tr:last-child td { border-bottom: none; }
        .dasha-table-inner td:first-child { border-right: 1px solid #eaedf0; font-weight: 600; width: 40%; background-color: #fafbfc; color: var(--text-dark); }
        .editable-date { display: inline-block; min-width: 80px; border-bottom: 1px dashed #b0bec5; outline: none; padding: 0 4px; color: var(--accent-green); cursor: text; }
        .editable-date:focus { background-color: #fff9c4; border-bottom-color: var(--primary-blue); }

        @media (max-width: 850px) {
            body { flex-direction: column; height: auto; overflow: auto; }
            .sidebar { width: 100%; box-sizing: border-box; padding: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
            .main-workspace { padding: 10px; width: 100%; box-sizing: border-box; gap: 20px; }
            .page-container { width: 100%; padding: 15px; }
            .header { flex-direction: column; text-align: center; gap: 10px; }
            .details-grid, .main-content { grid-template-columns: 1fr; }
            .dasha-grid { grid-template-columns: 1fr; } /* Stack tables on mobile */
            .summary-box { flex-direction: column; gap: 15px; }
            .detail-table td:first-child { text-align: left; }
        }

        /* Print Styles - Forces Two Pages */
        @media print {
            @page { size: A4 portrait; margin: 5mm; }
            body { background: white; display: block; height: auto; overflow: visible; margin: 0; }
            .sidebar { display: none !important; }
            
            .main-workspace { padding: 0; display: block; gap: 0; }
            
            .page-container { 
                box-shadow: none; 
                padding: 10px !important; 
                width: 100% !important; 
                max-width: 100% !important; 
                border: none;
                transform: scale(0.97); 
                transform-origin: top center;
                page-break-inside: avoid; 
                margin-bottom: 0;
            }
            
            /* Magic CSS to force Page 2 onto a new sheet */
            .page-2 { page-break-before: always; }
            
            .box { border-color: #000; }
            .details-grid, .main-content { grid-template-columns: 1fr 1fr !important; display: grid !important; }
            .dasha-grid { grid-template-columns: repeat(3, 1fr) !important; display: grid !important; }
            .summary-box { flex-direction: row !important; display: flex !important; }
            .header { flex-direction: row !important; text-align: left !important; }
            .detail-table td:first-child { text-align: right !important; }
            .editable-date { border-bottom: none; } /* Hide dashed lines when printing */
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <h2>ग्राहक तपशील</h2>
        
        <div class="form-group"><label>पूर्ण नाव</label><input type="text" id="clientNameInput" value="Amey Hatekar"></div>
        <div class="form-group"><label>जन्मस्थान</label><input type="text" id="clientPlaceInput" value="Amravati, India"></div>
        <div class="form-group"><label>जन्म तारीख</label><input type="date" id="clientDateInput" value="1998-04-25"></div>
        <div class="form-group"><label>जन्म वेळ</label><input type="time" id="clientTimeInput" value="09:09"></div>

        <button class="print-btn" onclick="window.print()">Print / Save PDF</button>

        <div id="dynamicControls"></div>
    </aside>

    <main class="main-workspace">
        <div class="page-container">
            <header class="header">
                <h1>कुंडली <span id="headerNameDisplay">Amey Hatekar</span></h1>
                <div class="logo-area"><span class="swastik">卐</span> स्वामिनी ज्योतिष</div>
            </header>

            <div class="box info-box">
                <div class="info-row-1">
                    नाम: <strong id="infoNameDisplay">Amey Hatekar</strong> 
                    स्थान: <strong id="infoPlaceDisplay">Amravati, India</strong> (Lat: 20.93 , Lon: 77.75)
                </div>
                <div class="info-row-2" id="infoDateTimeDisplay">
                    २५ एप्रि १९९८, शनिवार, ०९:०९ AM
                </div>
            </div>

            <div class="box summary-box">
                <div class="summary-item">
                    <div class="rashi-title">राशि ♓ <span data-bind="Rashi">मीन</span></div>
                    <div class="lagna-title">लग्न ♊ <span data-bind="Lagna">मिथुन</span></div>
                </div>
                <div class="summary-item summary-center">
                    <h3>नाम <span id="naamAksharDisplay">दो..</span></h3>
                    <p>दशा भोग्य बुध 10y 3m 13d</p>
                </div>
                <div class="summary-item">
                    <span class="mangal-dosh">मंगळ दोष</span>
                </div>
            </div>

            <div class="details-grid">
                <div class="box detail-card">
                    <table class="detail-table">
                        <tr><td>राशि स्वामी</td><td data-bind="RashiSwami">गुरु</td></tr>
                        <tr><td>नक्षत्र स्वामी</td><td data-bind="NakshatraSwami">बुध</td></tr>
                        <tr><td>नक्षत्र पाया</td><td data-bind="NakshtraPaya">सुवर्ण</td></tr>
                        <tr><td>योनि</td><td data-bind="Yoni">गज</td></tr>
                        <tr><td>गण</td><td data-bind="Gan">देव</td></tr>
                        <tr><td>नाडी</td><td data-bind="Naadi">अन्त्य (कफ)</td></tr>
                        <tr><td>वर्ण</td><td data-bind="Varna">ब्राह्मण</td></tr>
                    </table>
                </div>
                <div class="box detail-card">
                    <table class="detail-table">
                        <tr><td>तिथि</td><td data-bind="Tithi">चतुर्दशी, कृष्ण</td></tr>
                        <tr><td>नक्षत्र, पद</td><td data-bind="NakshatraPada">रेवती 2 दो</td></tr>
                        <tr><td>योग</td><td data-bind="Yog">विष्कुम्भ</td></tr>
                        <tr><td>करण</td><td data-bind="Karan">विष्टि भद्र</td></tr>
                        <tr><td>इष्टकाल</td><td data-bind="IshtKaal">08:07:05</td></tr>
                        <tr><td>सूर्योदय</td><td data-bind="Suryoday">05:54</td></tr>
                        <tr><td></td><td>शनिवार, चैत्र, 2055 विक्रम संवत</td></tr>
                    </table>
                </div>
            </div>

            <div class="box main-content">
                <div class="chart-container">
                    <svg class="svg-chart" viewBox="0 0 300 300" preserveAspectRatio="xMidYMid meet">
                        <rect x="0" y="0" width="300" height="300" class="chart-lines"/>
                        <line x1="0" y1="0" x2="300" y2="300" class="chart-lines"/>
                        <line x1="300" y1="0" x2="0" y2="300" class="chart-lines"/>
                        <polygon points="150,0 300,150 150,300 0,150" class="chart-lines"/>
                        <text x="150" y="15" text-anchor="middle" class="chart-num">3 Gem</text>
                        <text x="60" y="25" text-anchor="middle" class="chart-num">4 Can</text>
                        <text x="15" y="80" text-anchor="middle" class="chart-num">5 Leo</text>
                        <text x="35" y="150" text-anchor="middle" class="chart-num">6 Vir</text>
                        <text x="15" y="225" text-anchor="middle" class="chart-num">7 Lib</text>
                        <text x="60" y="285" text-anchor="middle" class="chart-num">8 Sco</text>
                        <text x="150" y="290" text-anchor="middle" class="chart-num">9 Sag</text>
                        <text x="240" y="285" text-anchor="middle" class="chart-num">10 Cap</text>
                        <text x="285" y="225" text-anchor="middle" class="chart-num">11 Aqu</text>
                        <text x="260" y="150" text-anchor="middle" class="chart-num">12 Pis</text>
                        <text x="285" y="80" text-anchor="middle" class="chart-num">1 Ari</text>
                        <text x="240" y="25" text-anchor="middle" class="chart-num">2 Tau</text>
                        <text x="150" y="80" text-anchor="middle" class="chart-planet">लग्न</text>
                        <text x="40" y="110" text-anchor="middle" class="chart-planet">राहू*</text>
                        <text x="60" y="260" text-anchor="middle" class="chart-planet">यम*</text>
                        <text x="240" y="260" text-anchor="middle" class="chart-planet">अरुण वरुण</text>
                        <text x="260" y="200" text-anchor="middle" class="chart-planet">केतू*</text>
                        <text x="260" y="215" text-anchor="middle" class="chart-planet">शुक्र गुरु</text>
                        <text x="210" y="145" text-anchor="middle" class="chart-planet">चन्द्र बुध</text>
                        <text x="260" y="100" text-anchor="middle" class="chart-planet">शनि^</text>
                        <text x="260" y="115" text-anchor="middle" class="chart-planet">सूर्य मंगल^</text>
                    </svg>
                </div>

                <div class="planet-table-section">
                    <h3>लग्न कुंडली</h3>
                    <table class="planet-table">
                        <tr><th>ग्रह</th><th>राशि निरायण</th><th>नक्षत्र, पद</th></tr>
                        <tr><td><span class="planet-dot dot-sun"></span> सूर्य</td><td data-bind="Rashi_सूर्य">♈ मेष</td><td>अश्विनी, 4 ला</td></tr>
                        <tr><td><span class="planet-dot dot-moon"></span> चन्द्र</td><td data-bind="Rashi_चन्द्र">♓ मीन</td><td>रेवती, 2 दो</td></tr>
                        <tr><td><span class="planet-dot dot-mars"></span> मंगल</td><td data-bind="Rashi_मंगल">♈ मेष</td><td>भरणी, 1 ली</td></tr>
                        <tr><td><span class="planet-dot dot-merc"></span> बुध</td><td data-bind="Rashi_बुध">♓ मीन</td><td>रेवती, 1 दे</td></tr>
                        <tr><td><span class="planet-dot dot-jup"></span> गुरु</td><td data-bind="Rashi_गुरु">♒ कुम्भ</td><td>पूर्वाभाद्रपदा, 2 सो</td></tr>
                        <tr><td><span class="planet-dot dot-ven"></span> शुक्र</td><td data-bind="Rashi_शुक्र">♒ कुम्भ</td><td>पूर्वाभाद्रपदा, 2 सो</td></tr>
                        <tr><td><span class="planet-dot dot-sat"></span> शनि</td><td data-bind="Rashi_शनि">♈ मेष</td><td>अश्विनी, 1 चु</td></tr>
                        <tr><td><span class="planet-dot dot-node">☊</span> राहू</td><td data-bind="Rashi_राहू">♌ सिंह</td><td>पूर्व फाल्गुनी, 1 मो</td></tr>
                        <tr><td><span class="planet-dot dot-node">☋</span> केतु</td><td data-bind="Rashi_केतु">♒ कुम्भ</td><td>शतभिष, 3 सी</td></tr>
                    </table>
                    <div class="footer-note">अयनांश लाहिरी / चित्रपक्ष = 23°50'</div>
                </div>
            </div>
        </div>

        <div class="page-container page-2">
            <header class="header">
                <h1>विंशोत्तरी महादशा व अंतर्दशा</h1>
                <div class="logo-area"><span class="swastik">卐</span> स्वामिनी ज्योतिष</div>
            </header>
            
            <div class="box info-box" style="padding: 10px;">
                <div class="info-row-1">
                    नाम: <strong id="infoNameDisplay2">Amey Hatekar</strong>
                </div>
                <div style="font-size: 14px; margin-top: 5px; color: var(--text-muted);">
                    (तारखेवर क्लिक करून तुम्ही ती थेट बदलू शकता / Click dates to edit)
                </div>
            </div>

            <div class="dasha-grid" id="dashaGridContainer"></div>
        </div>

    </main>

    <script>
        // 1. Core Header Listeners (Updates both pages)
        document.getElementById('clientNameInput').addEventListener('input', e => {
            const val = e.target.value || '______________';
            document.getElementById('headerNameDisplay').textContent = val;
            document.getElementById('infoNameDisplay').textContent = val;
            document.getElementById('infoNameDisplay2').textContent = val; // Page 2 name
        });
        document.getElementById('clientPlaceInput').addEventListener('input', e => {
            document.getElementById('infoPlaceDisplay').textContent = e.target.value || '______________';
        });

        const updateDateTime = () => {
            const d = document.getElementById('clientDateInput').value, t = document.getElementById('clientTimeInput').value;
            if(!d) return;
            const formattedDate = new Intl.DateTimeFormat('mr-IN', { day: 'numeric', month: 'short', year: 'numeric', weekday: 'long' }).format(new Date(d));
            let fTime = "";
            if(t) {
                let [h, m] = t.split(':');
                let ampm = h >= 12 ? 'PM' : 'AM';
                h = h % 12 || 12;
                const mDig = ['०','१','२','३','४','५','६','७','८','९'];
                const toMar = s => String(s).split('').map(x => mDig[x] || x).join('');
                fTime = `, ${toMar(h.toString().padStart(2, '0'))}:${toMar(m)} ${ampm}`;
            }
            document.getElementById('infoDateTimeDisplay').textContent = `${formattedDate}${fTime}`;
        };
        document.getElementById('clientDateInput').addEventListener('input', updateDateTime);
        document.getElementById('clientTimeInput').addEventListener('input', updateDateTime);
        updateDateTime();

        // 2. Data-Driven Dynamic Dropdowns Generator
        const jyotishData = {
            Rashi: ["मेष", "वृषभ", "मिथुन", "कर्क", "सिंह", "कन्या", "तुला", "वृश्चिक", "धनु", "मकर", "कुंभ", "मीन"],
            Lagna: ["मेष", "वृषभ", "मिथुन", "कर्क", "सिंह", "कन्या", "तुला", "वृश्चिक", "धनु", "मकर", "कुंभ", "मीन"],
            RashiSwami: ["सूर्य", "चंद्र", "मंगळ", "बुध", "गुरु", "शुक्र", "शनि", "राहू", "केतू"],
            NakshatraSwami: ["सूर्य", "चंद्र", "मंगळ", "बुध", "गुरु", "शुक्र", "शनि", "राहू", "केतू"],
            NakshtraPaya: ["सुवर्ण", "रजत", "ताम्र", "लोह"],
            Yoni: ["अश्व", "गज", "मेष", "सर्प", "श्वान", "मार्जार", "मूषक", "गौ", "महिष", "व्याघ्र", "मृग", "वानर", "नकुल", "सिंह"],
            Gan: ["देव", "मनुष्य", "राक्षस"],
            Naadi: ["आद्य (वात)", "मध्य (पित्त)", "अन्त्य (कफ)"],
            Varna: ["ब्राह्मण", "क्षत्रिय", "वैश्य", "शूद्र"],
            Tithi: ["प्रतिपदा", "द्वितीया", "तृतीया", "चतुर्थी", "पंचमी", "षष्ठी", "सप्तमी", "अष्टमी", "नवमी", "दशमी", "एकादशी", "द्वादशी", "त्रयोदशी", "चतुर्दशी", "पौर्णिमा", "अमावास्या"].flatMap(t=>[t+', शुक्ल', t+', कृष्ण']),
            NakshatraPada: [
                ["अश्विनी", ["चू", "चे", "चो", "ला"]], ["भरणी", ["ली", "लू", "ले", "लो"]], ["कृत्तिका", ["अ", "ई", "ऊ", "ए"]],
                ["रोहिणी", ["ओ", "वा", "वी", "वू"]], ["मृगशीर्ष", ["वे", "वो", "का", "की"]], ["आर्द्रा", ["कू", "घ", "ङ", "छ"]],
                ["पुनर्वसु", ["के", "को", "हा", "ही"]], ["पुष्य", ["हू", "हे", "हो", "डा"]], ["आश्लेषा", ["डी", "डू", "डे", "डो"]],
                ["मघा", ["मा", "मी", "मू", "मे"]], ["पूर्वा फाल्गुनी", ["मो", "टा", "टी", "टू"]], ["उत्तरा फाल्गुनी", ["टे", "टो", "पा", "पी"]],
                ["हस्त", ["पू", "ष", "ण", "ठ"]], ["चित्रा", ["पे", "पो", "रा", "री"]], ["स्वाती", ["रू", "रे", "रो", "ता"]],
                ["विशाखा", ["ती", "तू", "ते", "तो"]], ["अनुराधा", ["ना", "नी", "नू", "ने"]], ["ज्येष्ठा", ["नो", "या", "यी", "यू"]],
                ["मूळ", ["ये", "यो", "भा", "भी"]], ["पूर्वाषाढा", ["भू", "धा", "फा", "ढा"]], ["उत्तराषाढा", ["भे", "भो", "जा", "जी"]],
                ["श्रवण", ["खी", "खू", "खे", "खो"]], ["धनिष्ठा", ["गा", "गी", "गू", "गे"]], ["शततारका", ["गो", "सा", "सी", "सू"]],
                ["पूर्वा भाद्रपदा", ["से", "सो", "दा", "दी"]], ["उत्तरा भाद्रपदा", ["दू", "थ", "झ", "ञ"]], ["रेवती", ["दे", "दो", "चा", "ची"]]
            ].flatMap(([n, letters]) => letters.map((l, i) => `${n}, पद ${i + 1} (${l})`)),
            Yog: ["विष्कुंभ", "प्रीति", "आयुष्मान", "सौभाग्य", "शोभन", "अतिगंड", "सुकर्मा", "धृति", "शूल", "गंड", "वृद्धि", "ध्रुव", "व्याघात", "हर्षण", "वज्र", "सिद्धि", "व्यतीपात", "वरीयान", "परिघ", "शिव", "सिद्ध", "साध्य", "शुभ", "शुक्ल", "ब्रह्म", "ऐंद्र", "वैधृति"],
            Karan: ["बव", "बालव", "कौलव", "तैतिल", "गर", "वणिज", "विष्टि (भद्रा)", "शकुनि", "चतुष्पाद", "नाग", "किंस्तुघ्न"]
        };

        const extraTimers = { IshtKaal: { label: "इष्टकाल", type: "time", step: "1" }, Suryoday: { label: "सूर्योदय", type: "time" } };
        const rashiSymbols = ["♈ मेष", "♉ वृषभ", "♊ मिथुन", "♋ कर्क", "♌ सिंह", "♍ कन्या", "♎ तुला", "♏ वृश्चिक", "♐ धनु", "♑ मकर", "♒ कुंभ", "♓ मीन"];
        const planetsList = [
            { id: "सूर्य", default: "♈ मेष" }, { id: "चन्द्र", default: "♓ मीन" }, { id: "मंगल", default: "♈ मेष" },
            { id: "बुध", default: "♓ मीन" }, { id: "गुरु", default: "♒ कुम्भ" }, { id: "शुक्र", default: "♒ कुम्भ" },
            { id: "शनि", default: "♈ मेष" }, { id: "राहू", default: "♌ सिंह" }, { id: "केतु", default: "♒ कुम्भ" }
        ];

        const container = document.getElementById('dynamicControls');
        for (const [key, options] of Object.entries(jyotishData)) {
            let html = `<div class="form-group"><label>${key}</label><select data-control="${key}">`;
            options.forEach(opt => html += `<option value="${opt}">${opt}</option>`);
            html += `</select></div>`;
            container.insertAdjacentHTML('beforeend', html);
        }
        for (const [key, attrs] of Object.entries(extraTimers)) {
            let stepAttr = attrs.step ? `step="${attrs.step}"` : "";
            container.insertAdjacentHTML('beforeend', `<div class="form-group"><label>${attrs.label}</label><input type="${attrs.type}" data-control="${key}" ${stepAttr} value="00:00${attrs.step ? ':00' : ''}"></div>`);
        }
        container.insertAdjacentHTML('beforeend', '<h2 style="margin-top: 25px; border-bottom: 1px solid #455A64; padding-bottom: 10px;">ग्रह स्थिती (Planet Positions)</h2>');
        planetsList.forEach(p => {
            let html = `<div class="form-group"><label>${p.id} राशी</label><select data-control="Rashi_${p.id}">`;
            rashiSymbols.forEach(opt => html += `<option value="${opt}" ${opt === p.default ? 'selected' : ''}>${opt}</option>`);
            html += `</select></div>`;
            container.insertAdjacentHTML('beforeend', html);
        });

        container.addEventListener('input', (e) => {
            if(e.target.dataset.control) {
                const val = e.target.value;
                document.querySelectorAll(`[data-bind="${e.target.dataset.control}"]`).forEach(el => el.textContent = val);
                if(e.target.dataset.control === 'NakshatraPada') {
                    const match = val.match(/\(([^)]+)\)/);
                    if (match && match[1]) document.getElementById('naamAksharDisplay').textContent = match[1] + "..";
                }
            }
        });

        document.querySelectorAll('[data-control]').forEach(input => input.dispatchEvent(new Event('input', { bubbles: true })));

        // ==========================================
        // 3. PAGE 2: GENERATE DASHA TABLES MAGIC
        // ==========================================
        // The exact Vimshottari Mahadasha sequence and durations (Years)
        const dashaSequence = [
            { name: "सूर्य", years: 6 }, { name: "चंद्र", years: 10 }, { name: "मंगळ", years: 7 },
            { name: "राहू", years: 18 }, { name: "गुरु", years: 16 }, { name: "शनि", years: 19 },
            { name: "बुध", years: 17 }, { name: "केतू", years: 7 }, { name: "शुक्र", years: 20 }
        ];

        const dashaContainer = document.getElementById('dashaGridContainer');
        
        // Loop through all 9 planets to create 9 Mahadasha boxes
        dashaSequence.forEach((mahadasha, mIndex) => {
            let tableHTML = `
                <div class="dasha-box">
                    <div class="dasha-header-row">${mahadasha.name} महादशा (${mahadasha.years} वर्षे)</div>
                    <table class="dasha-table-inner">
            `;
            
            // Generate the 9 Antardashas inside this Mahadasha (always starts with the Mahadasha lord)
            for (let i = 0; i < 9; i++) {
                // Calculate the wrapping index to maintain sequence
                let aIndex = (mIndex + i) % 9;
                let antardasha = dashaSequence[aIndex];
                
                tableHTML += `
                    <tr>
                        <td>${antardasha.name} अंतर्दशा</td>
                        <td><span class="editable-date" contenteditable="true" spellcheck="false">dd-mm-yyyy</span></td>
                    </tr>
                `;
            }
            
            tableHTML += `</table></div>`;
            dashaContainer.insertAdjacentHTML('beforeend', tableHTML);
        });
    </script>
</body>
</html>